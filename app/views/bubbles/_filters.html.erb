<h1 class="txt-large">
  <div class="filter align-center gap-half" data-controller="dialog" data-action="keydown.esc->dialog#close click@document->dialog#closeOnClickOutside">
    <button class="btn btn--plain filter__button" data-action="click->dialog#toggle" data-dialog-modal-value="true">
      <% if params[:popped] %>
        Popped
      <% else %>
        Most active
      <% end %>
    </button>

    <dialog class="filter__popup panel fill-white shadow" data-dialog-target="dialog">
      <menu class="filter__menu unpad margin-none">
        <li><%= link_to "Most active", bucket_bubbles_path(bucket, bubble_filter_params.without(:popped)), class: "filter__button" %></li>
        <li><a href="#" class="filter__button">Most discussed</a></li>
        <li><a href="#" class="filter__button">Most boosted</a></li>
        <li><a href="#" class="filter__button">Newest</a></li>
        <li><a href="#" class="filter__button">Oldest</a></li>
        <li><%= link_to "Popped", bucket_bubbles_path(bucket, bubble_filter_params.merge(popped: true)), class: "filter__button" %></li>
      </menu>
    </dialog>
  </div>

  in

  <div class="filter align-center gap-half" data-controller="dialog" data-action="keydown.esc->dialog#close click@document->dialog#closeOnClickOutside">
    <button class="btn btn--plain filter__button" data-action="click->dialog#toggle" data-dialog-modal-value="true">
      <%= bucket.name %>
    </button>

    <dialog class="filter__popup panel fill-white shadow" data-dialog-target="dialog">
      <menu class="filter__menu unpad margin-none">
        <% Current.user.buckets.order(:name).each do |bucket| %>
          <li><%= link_to bucket.name, bucket_bubbles_path(bucket), class: "filter__button" %></li>
        <% end %>
      </menu>
    </dialog>

    <%= link_to edit_bucket_url(bucket), class: "btn btn--plain", style: "font-size: 0.25em;" do %>
      <%= image_tag "pencil.svg", aria: { hidden: true }, size: 24 %>
      <span class="for-screen-reader">Edit</span>
    <% end %>
  </div>
</h1>

<h2 class="txt-medium flex align-center justify-center gap-half">
  <%= tag ? "Tagged" : "with" %>

  <div class="filter align-center gap-half" data-controller="dialog" data-action="keydown.esc->dialog#close click@document->dialog#closeOnClickOutside">
    <button class="btn btn--plain filter__button" data-action="click->dialog#toggle" data-dialog-modal-value="true">
      <%= tag&.title || "any tag" %>
    </button>

    <dialog class="filter__popup panel fill-white shadow" data-dialog-target="dialog">
      <menu class="filter__menu unpad margin-none">
        <% bucket.tags.order(:title).each do |tag| %>
          <li><%= link_to tag.title, bucket_bubbles_path(bucket, bubble_filter_params.merge(tag_id: tag.id)) %></li>
        <% end %>
      </menu>
    </dialog>

    <% if tag %>
      <%= link_to bucket_bubbles_path(bucket, bubble_filter_params.without(:tag_id)), class: "btn", style: "font-size: 0.4em;" do %>
        <%= image_tag "remove.svg", aria: { hidden: true }, size: 24 %>
        <span class="for-screen-reader">Clear</span>
      <% end %>
    <% end %>
  </div>

  and

  <div class="filter align-center gap-half" data-controller="dialog" data-action="keydown.esc->dialog#close click@document->dialog#closeOnClickOutside">
    <button class="btn btn--plain filter__button" data-action="click->dialog#toggle" data-dialog-modal-value="true">
      assigned to <%= assignee&.name || "anyone" %>
    </button>

    <dialog class="filter__popup panel fill-white shadow" data-dialog-target="dialog">
      <menu class="filter__menu unpad margin-none">
        <% bucket.users.active.order(:name).each do |user| %>
          <li><%= link_to user.name, bucket_bubbles_path(bucket, bubble_filter_params.merge(assignee_id: user.id)) %></li>
        <% end %>
      </menu>
    </dialog>

    <% if assignee %>
      <%= link_to bucket_bubbles_path(bucket, bubble_filter_params.without(:assignee_id)), class: "btn", style: "font-size: 0.4em;" do %>
        <%= image_tag "remove.svg", aria: { hidden: true }, size: 24 %>
        <span class="for-screen-reader">Clear</span>
      <% end %>
    <% end %>
  </div>
</h2>
